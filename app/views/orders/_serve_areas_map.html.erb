<script type="text/javascript">
$(function() {
  var areas = [
    <% City.where(opened: true).each do |city| %>
      [
        <% city.coordinates.each do |c| %>
          new BMap.Point(<%= c[0] %>, <%= c[1] %>),
        <% end %>
      ],
    <% end %>
  ];
  areas.forEach(function(pts, i) {
    var polygon = new BMap.Polygon(pts,
      {strokeColor:"blue", strokeWeight:3, strokeOpacity:0.6, fillColor: "blue", fillOpacity: 0.05, enableMassClear: false });
    window.map.addOverlay(polygon);
  });
});
</script>
